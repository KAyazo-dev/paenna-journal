<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æƒ‘æ˜Ÿãƒ‘ã‚¨ãƒ³ãƒŠ å†’é™ºæ—¥èªŒ</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Noto+Sans+JP:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #060d1f;
    --panel: #0e1a35;
    --border: #2a4a7f;
    --cyan: #4cc9f0;
    --gold: #ffd166;
    --purple: #c4b5fd;
    --green: #6ee7b7;
    --red: #f87171;
    --text: #ffffff;
    --muted: #9ab0cc;
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Noto Sans JP', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ===== STARS ===== */
  #stars {
    position: fixed; inset: 0; z-index: 0; pointer-events: none;
  }
  .s {
    position: absolute; border-radius: 50%; background: #fff;
    animation: tw var(--d) ease-in-out infinite;
    animation-delay: var(--dl);
  }
  @keyframes tw {
    0%,100% { opacity: var(--mn); }
    50% { opacity: 1; }
  }

  /* ===== LAYOUT ===== */
  .wrap {
    position: relative; z-index: 1;
    max-width: 860px;
    margin: 0 auto;
    padding: 32px 20px 60px;
  }

  /* ===== HEADER ===== */
  header {
    margin-bottom: 36px;
    animation: fadeUp .6s ease both;
  }
  .planet-label {
    display: inline-flex; align-items: center; gap: 8px;
    background: rgba(76,201,240,0.1);
    border: 1px solid rgba(76,201,240,0.25);
    border-radius: 20px;
    padding: 5px 14px;
    font-size: 11px;
    letter-spacing: 3px;
    color: var(--cyan);
    margin-bottom: 12px;
    font-family: 'Orbitron', monospace;
  }
  .dot { width:6px; height:6px; border-radius:50%; background:var(--cyan); animation: pulse 1.8s infinite; }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.3} }

  h1 {
    font-family: 'Orbitron', monospace;
    font-size: clamp(22px, 4vw, 38px);
    font-weight: 900;
    background: linear-gradient(90deg, var(--cyan), #818cf8);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: 2px;
  }
  .h1-sub {
    font-size: 13px;
    color: var(--muted);
    margin-top: 6px;
    font-weight: 300;
  }

  /* ===== CARD ===== */
  .card {
    background: #0e1a35;
    border: 1px solid #2a4a7f;
    border-radius: 14px;
    position: relative;
    overflow: hidden;
  }
  .card::before {
    content:'';
    position:absolute; top:0; left:0; right:0; height:1px;
    background: linear-gradient(90deg, transparent, rgba(76,201,240,.4), transparent);
  }

  /* ===== WHAT TO DO GUIDE ===== */
  .guide {
    margin-bottom: 28px;
    animation: fadeUp .6s .1s ease both;
  }

  .guide-title {
    display: flex; align-items: center; gap: 8px;
    padding: 18px 20px 14px;
    font-family: 'Orbitron', monospace;
    font-size: 11px;
    letter-spacing: 2px;
    color: var(--gold);
  }
  .guide-title::before {
    content:'';
    width:3px; height:14px;
    background: linear-gradient(to bottom, var(--gold), #f97316);
    border-radius:2px;
  }

  .steps {
    padding: 0 16px 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .step {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    padding: 14px 16px;
    background: #152040;
    border: 1px solid #2a4a7f;
    border-radius: 10px;
    cursor: pointer;
    transition: background .2s, border-color .2s;
    position: relative;
    -webkit-user-select: none;
    user-select: none;
    touch-action: manipulation;
    -webkit-tap-highlight-color: rgba(76,201,240,0.2);
  }
  .step:hover {
    background: rgba(76,201,240,0.06);
    border-color: rgba(76,201,240,0.25);
  }
  .step.done {
    opacity: .55;
    border-color: rgba(110,231,183,0.2);
  }
  .step.done .step-num { background: rgba(110,231,183,0.2); color: var(--green); }
  .step.done::after {
    content: 'âœ“';
    position: absolute;
    right: 14px; top: 50%;
    transform: translateY(-50%);
    color: var(--green);
    font-size: 14px;
  }

  .step-num {
    width: 28px; height: 28px; flex-shrink: 0;
    border-radius: 8px;
    background: rgba(76,201,240,0.12);
    color: var(--cyan);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Orbitron', monospace;
    font-size: 12px;
    font-weight: 700;
    margin-top: 1px;
  }

  .step-body {}
  .step-name {
    font-size: 15px;
    font-weight: 700;
    color: #ffffff;
    margin-bottom: 5px;
  }
  .step-desc {
    font-size: 13px;
    color: #c8daf0;
    line-height: 1.7;
  }
  .step-tag {
    display: inline-block;
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 4px;
    margin-top: 5px;
    font-weight: 700;
  }
  .tag-daily { background: rgba(167,139,250,.15); color: var(--purple); }
  .tag-goal  { background: rgba(255,209,102,.12); color: var(--gold); }
  .tag-first { background: rgba(76,201,240,.12); color: var(--cyan); }

  /* ===== TWO COL ===== */
  .two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }
  @media(max-width:580px){ .two-col { grid-template-columns: 1fr; } }

  /* ===== CREDIT TRACKER ===== */
  .card-title {
    display: flex; align-items: center; gap: 8px;
    padding: 16px 18px 12px;
    font-family: 'Orbitron', monospace;
    font-size: 11px;
    letter-spacing: 2px;
  }
  .card-title::before {
    content:''; width:3px; height:13px;
    border-radius:2px;
  }
  .ct-title { color: var(--cyan); }
  .ct-title::before { background: linear-gradient(to bottom, var(--cyan), #6366f1); }
  .wish-title { color: var(--gold); }
  .wish-title::before { background: linear-gradient(to bottom, var(--gold), #f97316); }

  .credit-body { padding: 0 18px 18px; }

  .credit-big {
    font-family: 'Orbitron', monospace;
    font-size: 36px;
    font-weight: 900;
    color: var(--cyan);
    line-height: 1;
    margin-bottom: 4px;
  }
  .credit-label {
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 1px;
    margin-bottom: 16px;
  }

  .credit-goal {
    font-size: 12px;
    color: var(--muted);
    margin-bottom: 6px;
    display: flex; justify-content: space-between;
  }
  .ptrack {
    height: 6px;
    background: rgba(255,255,255,.06);
    border-radius:3px;
    overflow:hidden;
    margin-bottom: 12px;
  }
  .pfill {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, var(--cyan), var(--purple));
    animation: fillIn 1.2s .5s ease both;
    transform-origin: left;
  }
  @keyframes fillIn { from{transform:scaleX(0)} to{transform:scaleX(1)} }

  .credit-targets {
    display: flex;
    flex-direction: column;
    gap: 7px;
  }
  .ctarget {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 12px;
    background: #152040;
    border: 1px solid #2a4a7f;
    border-radius: 7px;
    font-size: 13px;
    cursor: pointer;
    transition: all .15s;
    touch-action: manipulation;
    color: #ffffff;
  }
  .ctarget:hover { background: #1a2f55; border-color: #4cc9f0; }
  .ctarget.claimed { opacity: .45; text-decoration: line-through; }
  .ctarget-name { display:flex; align-items:center; gap:7px; }
  .ctarget-cost { font-family:'Orbitron',monospace; font-size:11px; color: var(--gold); }

  /* ===== FORTUNE LOG ===== */
  .wish-body { padding: 0 18px 18px; }

  .fortune-big {
    text-align: center;
    padding: 14px 0 8px;
  }
  .fortune-count {
    font-family: 'Orbitron', monospace;
    font-size: 42px;
    font-weight: 900;
    color: var(--gold);
    line-height: 1;
    filter: drop-shadow(0 0 12px rgba(255,209,102,.4));
  }
  .fortune-sub {
    font-size: 11px;
    color: var(--muted);
    margin-top: 4px;
    letter-spacing: 2px;
  }

  .fortune-log {
    display: flex;
    flex-direction: column;
    gap: 7px;
    margin-top: 14px;
  }
  .flog-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    background: #152040;
    border: 1px solid #2a4a7f;
    border-radius: 7px;
    font-size: 12px;
  }
  .flog-rarity {
    width: 8px; height: 8px; border-radius:50%; flex-shrink:0;
  }
  .r-gold   { background: var(--gold); box-shadow: 0 0 6px rgba(255,209,102,.6); }
  .r-purple { background: var(--purple); box-shadow: 0 0 6px rgba(167,139,250,.6); }
  .r-gray   { background: rgba(255,255,255,.3); }

  .flog-name { flex:1; color: var(--text); }
  .flog-date { font-size:11px; color:var(--muted); font-family:'Orbitron',monospace; }

  .add-fortune {
    width: 100%;
    margin-top: 12px;
    padding: 10px;
    background: rgba(255,209,102,.06);
    border: 1px dashed rgba(255,209,102,.25);
    border-radius: 8px;
    color: rgba(255,209,102,.6);
    font-size: 11px;
    font-family: 'Orbitron', monospace;
    letter-spacing: 2px;
    cursor: pointer;
    transition: all .2s;
  }
  .add-fortune:hover {
    background: rgba(255,209,102,.1);
    border-color: rgba(255,209,102,.5);
    color: var(--gold);
  }

  /* ===== COSMO BOARD PROGRESS ===== */
  .board-section {
    animation: fadeUp .6s .3s ease both;
  }

  .board-body { padding: 0 18px 20px; }

  .board-stat {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 12px;
    margin-bottom: 18px;
  }
  .bstat {
    text-align: center;
    padding: 14px 10px;
    background: #152040;
    border: 1px solid #2a4a7f;
    border-radius: 9px;
  }
  .bstat-val {
    font-family: 'Orbitron', monospace;
    font-size: 22px;
    font-weight: 700;
    line-height: 1;
  }
  .bstat-label {
    font-size: 10px;
    color: var(--muted);
    margin-top: 4px;
    letter-spacing: 1px;
  }
  .v-cyan { color: var(--cyan); }
  .v-purple { color: var(--purple); }
  .v-gold { color: var(--gold); }

  .board-progress {
    margin-bottom: 14px;
  }
  .bp-header {
    display: flex; justify-content: space-between; align-items: baseline;
    margin-bottom: 6px;
  }
  .bp-label { font-size: 12px; color: var(--muted); }
  .bp-val { font-family: 'Orbitron', monospace; font-size: 12px; color: var(--purple); }

  .bp-note {
    font-size: 12px;
    color: #c8daf0;
    padding: 10px 12px;
    background: #152040;
    border: 1px solid #3a3a7f;
    border-radius: 8px;
    line-height: 1.7;
  }
  .bp-note b { color: var(--purple); }

  /* ===== MEMO ===== */
  .memo-section {
    margin-top: 20px;
    animation: fadeUp .6s .4s ease both;
  }
  .memo-title { color: var(--purple); }
  .memo-title::before { background: linear-gradient(to bottom, var(--purple), #ec4899); }

  .memo-area {
    padding: 0 18px 18px;
  }
  textarea {
    width: 100%;
    background: rgba(255,255,255,.03);
    border: 1px solid rgba(255,255,255,.08);
    border-radius: 9px;
    color: var(--text);
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 13px;
    padding: 14px;
    resize: none;
    outline: none;
    line-height: 1.8;
    transition: border-color .2s;
  }
  textarea:focus { border-color: rgba(167,139,250,.4); }
  textarea::placeholder { color: var(--muted); font-size: 12px; }

  /* ===== ANIMATION ===== */
  @keyframes fadeUp {
    from { opacity:0; transform:translateY(16px); }
    to   { opacity:1; transform:translateY(0); }
  }

  .two-col .card:first-child { animation: fadeUp .6s .2s ease both; }
  .two-col .card:last-child  { animation: fadeUp .6s .25s ease both; }
</style>
</head>
<body>

<div id="stars"></div>

<div class="wrap">

  <!-- HEADER -->
  <header>
    <div class="planet-label"><div class="dot"></div>COSMO EXPLORER</div>
    <h1>æƒ‘æ˜Ÿãƒ‘ã‚¨ãƒ³ãƒŠ å†’é™ºæ—¥èªŒ</h1>
    <p class="h1-sub">ã‚¬ãƒ©ã‚¹ã®æ˜Ÿ â€” åˆã‚ã¦ã®æ¢ç´¢ã‚’è¨˜éŒ²ã—ã‚ˆã†</p>
  </header>

  <!-- WHAT TO DO -->
  <div class="card guide">
    <div class="guide-title">ğŸ—ºï¸ ã¾ãšä½•ã‚’ã™ã‚Œã°ã„ã„ï¼Ÿ</div>
    <div class="steps" id="stepList">

      <div class="step" data-step>
        <div class="step-num">1</div>
        <div class="step-body">
          <div class="step-name">è§£æ”¾ã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ã‚‹</div>
          <div class="step-desc">ç„¦ãŒã‚Œã®å…¥æ±Ÿï¼ˆX:20.4 Y:20.0ï¼‰ã«ã„ã‚‹NPCã€Œã‚µãƒ¼ãƒãƒ³ã‚°ã‚¦ã‚§ã‚¤ã€ã‹ã‚‰ã‚¯ã‚¨ã‚¹ãƒˆã€Œæ–°ãŸãªã‚‹æœªçŸ¥ã¸ï¼ã€ã‚’å—æ³¨ã™ã‚‹ã€‚<br>ã‚¯ãƒ©ãƒ•ã‚¿ãƒ¼/ã‚®ãƒ£ã‚¶ãƒ©ãƒ¼ãŒLv10ä»¥ä¸Šã‚ã‚Œã°OKï¼</div>
          <span class="step-tag tag-first">ğŸš€ æœ€åˆã«ã‚„ã‚‹ã“ã¨</span>
        </div>
      </div>

      <div class="step" data-step>
        <div class="step-num">2</div>
        <div class="step-body">
          <div class="step-name">ãƒ‘ã‚¨ãƒ³ãƒŠã«ç§»å‹•ã™ã‚‹</div>
          <div class="step-desc">ãƒ™ã‚¹ãƒˆã‚¦ã‚§ã‚¤ãƒ»ãƒãƒ­ãƒ¼ã®ã‚¨ãƒ¼ãƒ†ãƒ©ã‚¤ãƒˆã‚’èª¿ã¹ã€Œæƒ‘æ˜Ÿãƒ‘ã‚¨ãƒ³ãƒŠã«è¡Œãã€ã‚’é¸æŠã€‚ã¾ãŸã¯ç„¦ãŒã‚Œã®å…¥æ±Ÿã®NPCã€Œã‚¯ãƒ«ãƒ¼ã‚¸ãƒ³ã‚°ã‚¦ã‚§ã‚¤ã€ã«è©±ã—ã‹ã‘ã¦ã‚‚OKã€‚</div>
          <span class="step-tag tag-first">ğŸš€ æœ€åˆã«ã‚„ã‚‹ã“ã¨</span>
        </div>
      </div>

      <div class="step" data-step>
        <div class="step-num">3</div>
        <div class="step-body">
          <div class="step-name">ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ã“ãªã™ï¼ˆæ¯æ—¥ï¼‰</div>
          <div class="step-desc">ã‚¯ãƒ©ãƒ•ã‚¿ãƒ¼ãƒ»ã‚®ãƒ£ã‚¶ãƒ©ãƒ¼ãƒ»æ¼å¸«ãã‚Œãã‚Œã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã€‚ã‚¯ãƒªã‚¢ã™ã‚‹ã¨ã€Œãƒ‘ã‚¨ãƒ³ãƒŠã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã€ã¨ã€Œã‚³ã‚¹ãƒ¢ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã€ãŒã‚‚ã‚‰ãˆã‚‹ã€‚ã“ã‚ŒãŒä¸»ãªé€šè²¨ï¼</div>
          <span class="step-tag tag-daily">ğŸ”„ ãƒ‡ã‚¤ãƒªãƒ¼</span>
        </div>
      </div>

      <div class="step" data-step>
        <div class="step-num">4</div>
        <div class="step-body">
          <div class="step-name">ã‚³ã‚¹ãƒ¢ãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚‹ãƒ»å¼·åŒ–ã™ã‚‹</div>
          <div class="step-desc">ãƒ‘ã‚¨ãƒ³ãƒŠå°‚ç”¨ã®ç‰¹æ®Šãªé“å…·ã€‚V1.1ã€œV1.5ã¾ã§å¼·åŒ–ã§ãã€æœ€å¤§å¼·åŒ–ã§IL750ç›¸å½“ã«ã€‚è£…å‚™ã™ã‚‹ã¨ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆç²å¾—ãƒœãƒ¼ãƒŠã‚¹ãŒã¤ãã®ã§æ—©ã‚ã«ä½œã‚ã†ï¼</div>
          <span class="step-tag tag-goal">â­ ç›®æ¨™</span>
        </div>
      </div>

      <div class="step" data-step>
        <div class="step-num">5</div>
        <div class="step-body">
          <div class="step-name">ã‚³ã‚¹ãƒ¢ãƒ•ã‚©ãƒ¼ãƒãƒ¥ãƒ³ã§ã‚¬ãƒãƒ£ã‚‹</div>
          <div class="step-desc">ãƒ‘ã‚¨ãƒ³ãƒŠã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚’ä½¿ã£ã¦ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’å›ã›ã‚‹ã€‚ãƒã‚¦ãƒ³ãƒˆã€Œãƒ‘ãƒ¯ãƒ¼ãƒ¬ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼ã€ã‚„ã‚¨ãƒ¢ãƒ¼ãƒˆã€Œå¼µã‚Šåˆ‡ã‚‹ã€ãªã©é™å®šå ±é…¬ãŒå½“ãŸã‚‹ã€‚æ¥½ã—ã„ã‚„ã¤ï¼</div>
          <span class="step-tag tag-daily">ğŸ° æ¥½ã—ã¿æ </span>
        </div>
      </div>

      <div class="step" data-step>
        <div class="step-num">6</div>
        <div class="step-body">
          <div class="step-name">ã‚³ã‚¹ãƒ¢ãƒœãƒ¼ãƒ‰ã‚’ç›®æŒ‡ã™ï¼ˆé•·æœŸï¼‰</div>
          <div class="step-desc">EX+ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã€Œæ‰‹å½¢ã€ã‚’é›†ã‚ã‚‹ã€‚æ‰‹å½¢100æšâ†’è¨¼æ›¸1æšã€è¨¼æ›¸60æšâ†’ãƒã‚¦ãƒ³ãƒˆã€Œã‚³ã‚¹ãƒ¢ãƒœãƒ¼ãƒ‰ã€ï¼æ‰‹å½¢6000æšå¿…è¦ãªã®ã§ã®ã‚“ã³ã‚Šç¶™ç¶šãŒå¤§äº‹ã€‚</div>
          <span class="step-tag tag-goal">ğŸ† ã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</span>
        </div>
      </div>

    </div>
  </div>

  <!-- CREDIT & FORTUNE -->
  <div class="two-col">

    <!-- COSMO CREDIT -->
    <div class="card">
      <div class="card-title ct-title">COSMO CREDIT</div>
      <div class="credit-body">
        <div class="credit-big" id="creditVal">0</div>
        <div class="credit-label">ç¾åœ¨ã®æ‰€æŒã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ</div>
        <div style="display:flex;gap:8px;margin-bottom:14px">
          <button data-credit="-500" style="flex:1;padding:9px;background:#2a1a2e;border:1px solid #f87171;border-radius:7px;color:#f87171;font-size:13px;cursor:pointer;touch-action:manipulation;font-weight:700;">âˆ’500</button>
          <button data-credit="500"  style="flex:1;padding:9px;background:#0e2a35;border:1px solid #4cc9f0;border-radius:7px;color:#4cc9f0;font-size:13px;cursor:pointer;touch-action:manipulation;font-weight:700;">ï¼‹500</button>
          <button data-credit="1000" style="flex:1;padding:9px;background:#0e2a20;border:1px solid #6ee7b7;border-radius:7px;color:#6ee7b7;font-size:13px;cursor:pointer;touch-action:manipulation;font-weight:700;">ï¼‹1000</button>
        </div>

        <div class="credit-goal">
          <span>ğŸ¯ æ¬¡ã®ç›®æ¨™</span>
          <span id="creditGoalName" style="color:var(--gold)">ã‚¹ãƒšãƒ¼ã‚¹ãƒ€ãƒ«ãƒ¡ãƒ«</span>
        </div>
        <div class="ptrack"><div class="pfill" id="pfill" style="width:0%"></div></div>
        <div style="font-size:12px;color:#9ab0cc;margin-bottom:14px;text-align:right" id="creditGoalSub">0 / 29,000</div>

        <div class="credit-targets">
          <div class="ctarget" data-goal-name="ã‚¹ãƒšãƒ¼ã‚¹ãƒ€ãƒ«ãƒ¡ãƒ«" data-goal-cost="29000">
            <div class="ctarget-name">ğŸª ã‚¹ãƒšãƒ¼ã‚¹ãƒ€ãƒ«ãƒ¡ãƒ«ï¼ˆãƒã‚¦ãƒ³ãƒˆï¼‰</div>
            <div class="ctarget-cost">29,000</div>
          </div>
          <div class="ctarget" data-goal-name="ã‚³ã‚¹ãƒ¢ã‚­ãƒ£ãƒ—ãƒ†ãƒ³è£…å‚™ï¼ˆèƒ´ï¼‰" data-goal-cost="8400">
            <div class="ctarget-name">ğŸ‘• ã‚³ã‚¹ãƒ¢ã‚­ãƒ£ãƒ—ãƒ†ãƒ³è£…å‚™ï¼ˆèƒ´ï¼‰</div>
            <div class="ctarget-cost">8,400</div>
          </div>
          <div class="ctarget" data-goal-name="ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒˆ" data-goal-cost="6000">
            <div class="ctarget-name">ğŸ–¼ï¸ ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒˆ</div>
            <div class="ctarget-cost">6,000</div>
          </div>
        </div>
      </div>
    </div>

    <!-- COSMO FORTUNE -->
    <div class="card">
      <div class="card-title wish-title">COSMO FORTUNE</div>
      <div class="wish-body">
        <div class="fortune-big">
          <div class="fortune-count" id="fortuneCount">0</div>
          <div class="fortune-sub">å›ã¾ã‚ã—ãŸ</div>
        </div>

        <div style="display:flex;gap:8px;margin:12px 0">
          <button id="fortuneBtn" style="flex:1;padding:11px;background:#2a2010;border:1px solid #ffd166;border-radius:8px;color:#ffd166;font-size:14px;cursor:pointer;font-family:'Noto Sans JP',sans-serif;touch-action:manipulation;font-weight:700;">ğŸ° 1å›ã¾ã‚ã—ãŸï¼</button>
        </div>

        <div class="fortune-log" id="fortuneLog">
          <div style="font-size:13px;color:#9ab0cc;text-align:center;padding:10px 0;" data-placeholder>ã¾ã è¨˜éŒ²ãªã—<br>ã‚¬ãƒãƒ£ã£ãŸã‚‰è¨˜éŒ²ã—ã‚ˆã†ï¼</div>
        </div>
      </div>
    </div>

  </div>

  <!-- COSMO BOARD PROGRESS -->
  <div class="card board-section">
    <div class="card-title" style="color:var(--purple)">
      <span style="width:3px;height:13px;background:linear-gradient(to bottom,var(--purple),#ec4899);border-radius:2px;"></span>
      ğŸ† ã‚³ã‚¹ãƒ¢ãƒœãƒ¼ãƒ‰é€²æ—
    </div>
    <div class="board-body">
      <div class="board-stat">
        <div class="bstat">
          <div class="bstat-val v-cyan" id="tegataCnt">0</div>
          <div class="bstat-label">æ‰‹å½¢ï¼ˆæšï¼‰</div>
        </div>
        <div class="bstat">
          <div class="bstat-val v-purple" id="shoshoCnt">0</div>
          <div class="bstat-label">è¨¼æ›¸ï¼ˆæšï¼‰</div>
        </div>
        <div class="bstat">
          <div class="bstat-val v-gold" id="boardPct">0%</div>
          <div class="bstat-label">é”æˆç‡</div>
        </div>
      </div>

      <div style="display:flex;gap:8px;margin-bottom:16px">
        <button data-tegata="1"    style="flex:1;padding:9px;background:#0e2a35;border:1px solid #4cc9f0;border-radius:7px;color:#4cc9f0;font-size:12px;cursor:pointer;touch-action:manipulation;font-weight:700;">æ‰‹å½¢ ï¼‹1</button>
        <button data-tegata="10"   style="flex:1;padding:9px;background:#0e2a35;border:1px solid #4cc9f0;border-radius:7px;color:#4cc9f0;font-size:12px;cursor:pointer;touch-action:manipulation;font-weight:700;">æ‰‹å½¢ ï¼‹10</button>
        <button data-tegata="100"  style="flex:1;padding:9px;background:#0e2a35;border:1px solid #4cc9f0;border-radius:7px;color:#4cc9f0;font-size:12px;cursor:pointer;touch-action:manipulation;font-weight:700;">æ‰‹å½¢ ï¼‹100</button>
        <button data-tegata="-1"   style="flex:1;padding:9px;background:#2a1a1a;border:1px solid #f87171;border-radius:7px;color:#f87171;font-size:12px;cursor:pointer;touch-action:manipulation;font-weight:700;">âˆ’1</button>
      </div>

      <div class="board-progress">
        <div class="bp-header">
          <span class="bp-label">ã‚³ã‚¹ãƒ¢ãƒœãƒ¼ãƒ‰ã¾ã§ã®é“ã®ã‚Š</span>
          <span class="bp-val" id="boardProgressVal">0 / 6,000 æ‰‹å½¢</span>
        </div>
        <div class="ptrack"><div class="pfill" id="boardFill" style="width:0%;background:linear-gradient(90deg,var(--purple),#ec4899)"></div></div>
      </div>

      <div class="bp-note">
        ğŸ’¡ <b>æ‰‹å½¢100æš</b> â†’ è¨¼æ›¸1æšã€€ï¼ã€€<b>è¨¼æ›¸60æš</b>ï¼ˆï¼æ‰‹å½¢6,000æšï¼‰â†’ ãƒã‚¦ãƒ³ãƒˆã€Œã‚³ã‚¹ãƒ¢ãƒœãƒ¼ãƒ‰ã€<br>
        EX+ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ãŸã³ã«æ‰‹å½¢ãŒå…¥æ‰‹ã§ãã¾ã™ã€‚ç„¦ã‚‰ãšã‚³ãƒ„ã‚³ãƒ„ã„ã“ã†ï¼
      </div>
    </div>
  </div>

  <!-- MEMO -->
  <div class="card memo-section">
    <div class="card-title memo-title">ğŸ“ ä»Šæ—¥ã®ãƒ¡ãƒ¢</div>
    <div class="memo-area">
      <textarea rows="4" placeholder="ä»Šæ—¥ã©ã“ã‚’æ¢ç´¢ã—ãŸã‹ã€æ°—ã¥ã„ãŸã“ã¨ã€æ¬¡ã‚„ã‚‹ã“ã¨ãªã©è‡ªç”±ã«æ›¸ã„ã¦ã­&#13;&#10;ä¾‹ï¼šåˆã‚ã¦EX+æŒ‘æˆ¦ã—ãŸï¼æ‰‹å½¢3æšã‚‚ã‚‰ãˆãŸã€‚æ¬¡ã¯æ¡æ˜ç³»ãƒŸãƒƒã‚·ãƒ§ãƒ³è©¦ã—ãŸã„ã€‚"></textarea>
    </div>
  </div>

</div>

<script>
// ===== STARS =====
const sf = document.getElementById('stars');
for(let i=0;i<150;i++){
  const s=document.createElement('div'); s.className='s';
  const sz=Math.random()*2+.5;
  s.style.cssText=`width:${sz}px;height:${sz}px;left:${Math.random()*100}%;top:${Math.random()*100}%;--d:${(Math.random()*3+2).toFixed(1)}s;--dl:${(Math.random()*5).toFixed(1)}s;--mn:${(Math.random()*.3+.1).toFixed(2)}`;
  sf.appendChild(s);
}

// ===== localStorage ã‚­ãƒ¼ =====
const LS = 'paenna_journal_v1';

// ===== ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ =====
function loadData() {
  try {
    const raw = localStorage.getItem(LS);
    return raw ? JSON.parse(raw) : null;
  } catch(e) { return null; }
}

// ===== ãƒ‡ãƒ¼ã‚¿ä¿å­˜ =====
function saveData() {
  const stepsState = [];
  document.querySelectorAll('[data-step]').forEach(function(el){
    stepsState.push(el.classList.contains('done'));
  });

  const fortuneLogs = [];
  document.querySelectorAll('#fortuneLog .flog-item').forEach(function(el){
    fortuneLogs.push({
      name: el.querySelector('.flog-name').textContent,
      rarity: el.querySelector('.flog-rarity').className.replace('flog-rarity r-',''),
      date: el.querySelector('.flog-date').textContent
    });
  });

  const memo = document.querySelector('textarea') ? document.querySelector('textarea').value : '';

  localStorage.setItem(LS, JSON.stringify({
    credit, fortuneCount, tegata, currentGoal, stepsState, fortuneLogs, memo
  }));
}

// ===== STATE =====
let credit = 0;
let fortuneCount = 0;
let tegata = 0;
let currentGoal = { name:'ã‚¹ãƒšãƒ¼ã‚¹ãƒ€ãƒ«ãƒ¡ãƒ«', cost:29000 };
const fortuneItems = [
  { name:'ãƒ‘ãƒ¯ãƒ¼ãƒ¬ã‚¹ãƒ­ãƒ¼ãƒ€ãƒ¼', rarity:'gold' },
  { name:'ãƒ›ã‚¤ãƒ¼ãƒ«ãƒ­ãƒ¼ãƒ€ãƒ¼', rarity:'gold' },
  { name:'ã‚¨ãƒ¢ãƒ¼ãƒˆï¼šå¼µã‚Šåˆ‡ã‚‹', rarity:'purple' },
  { name:'ã‚³ã‚¹ãƒ¢ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆé˜²å…·', rarity:'purple' },
  { name:'ã‚³ã‚¹ãƒ¢ãƒ™ãƒ³ãƒ', rarity:'gray' },
  { name:'ã‚³ã‚¹ãƒ¢ã‚¿ãƒ¼ãƒŸãƒŠãƒ«', rarity:'gray' },
  { name:'ã‚³ã‚¹ãƒ¢ã‚­ãƒƒãƒãƒ³ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³', rarity:'gray' },
];

function updateCredit(){
  document.getElementById('creditVal').textContent = credit.toLocaleString();
  const pct = Math.min(credit/currentGoal.cost*100,100);
  document.getElementById('pfill').style.width = pct+'%';
  document.getElementById('creditGoalSub').textContent = credit.toLocaleString()+' / '+currentGoal.cost.toLocaleString();
  document.getElementById('creditGoalName').textContent = currentGoal.name;
}

function addCredit(n){
  credit = Math.max(0, credit+n);
  updateCredit();
  saveData();
}

function addFortune(){
  fortuneCount++;
  document.getElementById('fortuneCount').textContent = fortuneCount;

  const item = fortuneItems[Math.floor(Math.random()*fortuneItems.length)];
  const log = document.getElementById('fortuneLog');
  // ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’æ¶ˆã™
  const placeholder = log.querySelector('[data-placeholder]');
  if(placeholder) placeholder.remove();

  const now = new Date();
  const dt = `${(now.getMonth()+1).toString().padStart(2,'0')}.${now.getDate().toString().padStart(2,'0')}`;
  addFortuneItem(log, item.name, item.rarity, dt, true);
  if(log.children.length > 5) log.removeChild(log.lastChild);
  saveData();
}

function addFortuneItem(log, name, rarity, dt, animate){
  const el = document.createElement('div');
  el.className='flog-item';
  if(animate){ el.style.opacity='0'; el.style.transform='translateY(-8px)'; }
  el.innerHTML=`<div class="flog-rarity r-${rarity}"></div><div class="flog-name">${name}</div><div class="flog-date">${dt}</div>`;
  log.prepend(el);
  if(animate){
    requestAnimationFrame(()=>{
      el.style.transition='all .3s ease';
      el.style.opacity='1'; el.style.transform='translateY(0)';
    });
  }
}

function addTegata(n){
  tegata = Math.max(0, tegata+n);
  const shosho = Math.floor(tegata/100);
  document.getElementById('tegataCnt').textContent = tegata;
  document.getElementById('shoshoCnt').textContent = shosho;
  const pct = Math.min(tegata/6000*100,100);
  document.getElementById('boardPct').textContent = pct.toFixed(1)+'%';
  document.getElementById('boardProgressVal').textContent = tegata.toLocaleString()+' / 6,000 æ‰‹å½¢';
  document.getElementById('boardFill').style.width = pct+'%';
  saveData();
}

// ===== ã‚¹ãƒ†ãƒƒãƒ—ï¼šã‚¿ãƒƒãƒ—å¯¾å¿œ =====
document.querySelectorAll('[data-step]').forEach(function(el){
  el.addEventListener('touchend', function(e){
    e.preventDefault();
    el.classList.toggle('done');
    saveData();
  });
  el.addEventListener('click', function(){
    el.classList.toggle('done');
    saveData();
  });
});

// ===== ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆãƒœã‚¿ãƒ³ =====
document.querySelectorAll('[data-credit]').forEach(function(btn){
  btn.addEventListener('click', function(){ addCredit(Number(btn.dataset.credit)); });
});

// ===== ç›®æ¨™é¸æŠ =====
document.querySelectorAll('[data-goal-name]').forEach(function(el){
  el.addEventListener('click', function(){
    currentGoal = { name: el.dataset.goalName, cost: Number(el.dataset.goalCost) };
    el.style.background='rgba(255,209,102,.12)';
    el.style.borderColor='rgba(255,209,102,.4)';
    setTimeout(()=>{ el.style.background=''; el.style.borderColor=''; }, 400);
    updateCredit();
    saveData();
  });
});

// ===== ãƒ•ã‚©ãƒ¼ãƒãƒ¥ãƒ³ãƒœã‚¿ãƒ³ =====
document.getElementById('fortuneBtn').addEventListener('click', addFortune);

// ===== æ‰‹å½¢ãƒœã‚¿ãƒ³ =====
document.querySelectorAll('[data-tegata]').forEach(function(btn){
  btn.addEventListener('click', function(){ addTegata(Number(btn.dataset.tegata)); });
});

// ===== ãƒ¡ãƒ¢è‡ªå‹•ä¿å­˜ =====
const memoEl = document.querySelector('textarea');
if(memoEl){
  memoEl.addEventListener('input', function(){
    clearTimeout(memoEl._saveTimer);
    memoEl._saveTimer = setTimeout(saveData, 800);
  });
}

// ===== èµ·å‹•æ™‚ã«ãƒ‡ãƒ¼ã‚¿å¾©å…ƒ =====
(function restoreData(){
  const d = loadData();
  if(!d) {
    updateCredit();
    addTegata(0);
    return;
  }

  // æ•°å€¤ç³»
  credit = d.credit || 0;
  fortuneCount = d.fortuneCount || 0;
  tegata = d.tegata || 0;
  if(d.currentGoal) currentGoal = d.currentGoal;

  updateCredit();
  addTegata(0); // è¡¨ç¤ºæ›´æ–°ã®ãŸã‚0ã‚’åŠ ç®—

  // ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹
  if(d.stepsState){
    document.querySelectorAll('[data-step]').forEach(function(el, i){
      if(d.stepsState[i]) el.classList.add('done');
    });
  }

  // ãƒ•ã‚©ãƒ¼ãƒãƒ¥ãƒ³ãƒ­ã‚°
  if(d.fortuneLogs && d.fortuneLogs.length > 0){
    const log = document.getElementById('fortuneLog');
    const placeholder = log.querySelector('[data-placeholder]');
    if(placeholder) placeholder.remove();
    // å¤ã„é †ã«è¿½åŠ ï¼ˆprependã™ã‚‹ã®ã§é€†é †ï¼‰
    [...d.fortuneLogs].reverse().forEach(function(item){
      addFortuneItem(log, item.name, item.rarity, item.date, false);
    });
    document.getElementById('fortuneCount').textContent = fortuneCount;
  }

  // ãƒ¡ãƒ¢
  if(d.memo && memoEl) memoEl.value = d.memo;
})();

</script>
</body>
</html>
